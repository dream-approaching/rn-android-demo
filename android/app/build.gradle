apply plugin: 'com.android.application'
def dimensions_debug = "debug"
def dimensions_release = "release"

project.ext.react = [
        entryFile    : "index.js",
        bundleInDebug: true
]

apply from: "../../node_modules/react-native/react.gradle"
apply from: "../../node_modules/react-native-code-push/android/codepush.gradle"

def static releaseTime() {
    return new Date().format("yyyy-MM-dd", TimeZone.getTimeZone("UTC"))
}

def static getVersionCode(buildType) {
    if ('release' == buildType) {
        10001300//国内版
    } else {
        10001300//debug
    }
}

def static getVersionName(buildType) {
    if ('release' == buildType) {
        "1.0.13"//国内版
    } else {
        "1.0.13"//debug
    }
}

android {
    compileSdkVersion 28
    defaultConfig {
        applicationId "com.lieying.petcat"
        minSdkVersion rootProject.ext.minSdk
        targetSdkVersion rootProject.ext.targetSdk
        versionCode 10001300
        versionName "1.0.13"
        multiDexEnabled true

        ndk {
            //根据需要 自行选择添加的对应cpu类型的.so库。
            abiFilters 'armeabi', 'armeabi-v7a'
            // 还可以添加 'x86', 'x86_64', 'mips', 'mips64', 'arm64-v8a'
        }
        manifestPlaceholders = [
                XG_ACCESS_ID : "2100333712",
                XG_ACCESS_KEY: "AS5X1T49X5RE",
        ]
    }
    signingConfigs {
        debug {
            storeFile file("Weiwang_browser_key.jks")
            storePassword "WWbrowser2016**"
            keyAlias "weiwang"
            keyPassword "WWbrowser2016**"
        }
        relealse {
            storeFile file("Weiwang_browser_key.jks")
            storePassword "WWbrowser2016**"
            keyAlias "weiwang"
            keyPassword "WWbrowser2016**"
        }
    }
    buildTypes {
        debug {
//            minifyEnabled false
            debuggable true
            signingConfig signingConfigs.debug
            minifyEnabled false
            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'

            buildConfigField("String", "UMENG_APP_KEY", "\"5cdd4375570df301b1000d02\"")
            buildConfigField("String", "UMENG_SECRET", "\"1\"")
            buildConfigField("String", "WECHAT_APPKEY", "\"wxfce86cf1b17f7e90\"")
            buildConfigField("String", "WECHAT_SECRET", "\"2b9bf41ccf5aa6e45e5ed4f3c0dfdab3\"")
            buildConfigField("String", "QQ_APPKEY", "\"1.0.385877\"")
            buildConfigField("String", "QQ_SECRET", "\"1xCo8itrjmSXBBUT\"")
            buildConfigField("String", "SINA_APPKEY", "\"1789429604\"")
            buildConfigField("String", "SINA_SECRET", "\"4b46ec1f685c29229b43c3b9e826072f\"")
            buildConfigField("String", "MAIN_HOST", "\"http://192.168.0.200:1230\"")
            buildConfigField("String", "APP_ID", "\"2\"")
            buildConfigField("String", "APP_VER", "\"1\"")
            buildConfigField("String", "APP_VER_CODE", "\"1\"")
            buildConfigField("String", "CN", "\"1\"")
            buildConfigField("String", "CODEPUSH_KEY", "\"\"")
            // buildConfigField ("String", "CODEPUSH_KEY", "\"o4iJo8DvOvPwZqmDoQ5LREDtjbLU020bac4f-d7e1-48e7-8584-7bdb6a68f649\"")
            // applicationIdSuffix ".debug"

            buildConfigField("String", "USER_HOST", "\"http://api.user.lynav.com\"")
            buildConfigField("String", "CONTENT_HOST", "\"http://api.content.lynav.com\"")
            buildConfigField("String", "APP_STORE_HOST", "\"http://api.appstore.lynav.com\"")
        }

        releaseStaging {

            //混淆
            minifyEnabled true
            debuggable false
            shrinkResources false
            //Zipalign优化
            zipAlignEnabled true
            signingConfig signingConfigs.relealse
            matchingFallbacks = ['release']
            proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'
            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'
            buildConfigField("String", "UMENG_APP_KEY", "\"5cdd4375570df301b1000d02\"")
            buildConfigField("String", "UMENG_SECRET", "\"1\"")
            buildConfigField("String", "WECHAT_APPKEY", "\"wxfce86cf1b17f7e90\"")
            buildConfigField("String", "WECHAT_SECRET", "\"2b9bf41ccf5aa6e45e5ed4f3c0dfdab3\"")
            buildConfigField("String", "QQ_APPKEY", "\"1.0.385877\"")
            buildConfigField("String", "QQ_SECRET", "\"1xCo8itrjmSXBBUT\"")
            buildConfigField("String", "SINA_APPKEY", "\"1789429604\"")
            buildConfigField("String", "SINA_SECRET", "\"4b46ec1f685c29229b43c3b9e826072f\"")
//            buildConfigField("String", "MAIN_HOST", "\"http://192.168.0.200:8060\"")
            buildConfigField("String", "APP_ID", "\"2\"")
            buildConfigField("String", "APP_VER", "\"1\"")
            buildConfigField("String", "APP_VER_CODE", "\"1\"")
            buildConfigField("String", "CN", "\"1\"")
            buildConfigField("String", "MAIN_HOST", "\"http://192.168.0.200:1530\"")
            buildConfigField("String", "CODEPUSH_KEY", "\"o4iJo8DvOvPwZqmDoQ5LREDtjbLU020bac4f-d7e1-48e7-8584-7bdb6a68f649\"")
            buildConfigField("String", "USER_HOST", "\"http://api.user.lynav.com\"")
            buildConfigField("String", "CONTENT_HOST", "\"http://api.content.lynav.com\"")
            buildConfigField("String", "APP_STORE_HOST", "\"http://api.appstore.lynav.com\"")
        }

        release {
            //混淆
            minifyEnabled true
            debuggable false
            shrinkResources false
            //Zipalign优化
            zipAlignEnabled true
            signingConfig signingConfigs.relealse

            proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'
            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'
            buildConfigField("String", "UMENG_APP_KEY", "\"5cdd4375570df301b1000d02\"")
            buildConfigField("String", "UMENG_SECRET", "\"1\"")
            buildConfigField("String", "WECHAT_APPKEY", "\"wxfce86cf1b17f7e90\"")
            buildConfigField("String", "WECHAT_SECRET", "\"2b9bf41ccf5aa6e45e5ed4f3c0dfdab3\"")
            buildConfigField("String", "QQ_APPKEY", "\"1.0.385877\"")
            buildConfigField("String", "QQ_SECRET", "\"1xCo8itrjmSXBBUT\"")
            buildConfigField("String", "SINA_APPKEY", "\"1789429604\"")
            buildConfigField("String", "SINA_SECRET", "\"4b46ec1f685c29229b43c3b9e826072f\"")
            buildConfigField("String", "MAIN_HOST", "\"http://192.168.0.200:1230\"")
            buildConfigField("String", "APP_ID", "\"2\"")
            buildConfigField("String", "APP_VER", "\"1\"")
            buildConfigField("String", "APP_VER_CODE", "\"1\"")
            buildConfigField("String", "CN", "\"1\"")
            buildConfigField("String", "CODEPUSH_KEY", "\"bmR48duSItRtLTvGmuYJ5Cz-BcGr020bac4f-d7e1-48e7-8584-7bdb6a68f649\"")

            buildConfigField("String", "USER_HOST", "\"http://api.user.lynav.com\"")
            buildConfigField("String", "CONTENT_HOST", "\"http://api.content.lynav.com\"")
            buildConfigField("String", "APP_STORE_HOST", "\"http://api.appstore.lynav.com\"")
        }

//        pretest {
//            minifyEnabled true
//            debuggable false
//            proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'
//            buildConfigField("String", "MAIN_HOST", "\"http://192.168.0.130:8060\"")
//        }

    }

    flavorDimensions dimensions_release
    //渠道Flavors
    //批量打包命令：gradlew assembleRelease
    productFlavors {
        //友盟： UMENG_CHANNEL_VALUE
        CESHI {//测试
            dimension dimensions_release
            manifestPlaceholders = [UMENG_CHANNEL_VALUE: "999"]
        }
    }

    applicationVariants.all { variant ->
        variant.outputs.all {
            outputFileName = "shumei_V${getVersionName(variant.buildType.name)}_${releaseTime()}_${variant.productFlavors[0].name}.apk"
        }
    }
    compileOptions {
        sourceCompatibility JavaVersion.VERSION_1_8
        targetCompatibility JavaVersion.VERSION_1_8
    }

}

dependencies {
    implementation fileTree(dir: 'libs', include: ['*.jar'])
    // 导入腾讯云短视频SDK jar
    implementation fileTree(dir: 'src/main/jniLibs', includes: ['*.jar'])

    implementation project(':react-native-fetch-blob')
    implementation 'com.facebook.fresco:animated-gif:1.10.0'
    implementation project(':react-native-amap-geolocation')
    implementation project(':react-native-webview')
    implementation project(':react-native-spring-scrollview')
    implementation project(':react-native-code-push')
    implementation project(':react-native-gesture-handler')
    implementation fileTree(include: ['*.jar'], dir: 'libs')
    implementation "com.android.support:appcompat-v7:${rootProject.ext.support}"
    implementation "com.android.support:design:${rootProject.ext.support}"
    implementation 'com.android.support.constraint:constraint-layout:1.1.3'
    implementation "com.android.support:support-vector-drawable:${rootProject.ext.support}"
    implementation 'com.github.bumptech.glide:glide:4.9.0'
    implementation "com.android.support:support-v4:${rootProject.ext.support}"
    implementation "com.android.support:recyclerview-v7:${rootProject.ext.support}"
    implementation 'com.squareup.retrofit2:retrofit:2.5.0'
    implementation 'com.android.support:support-v4:28.0.0'
    implementation 'com.android.support:recyclerview-v7:28.0.0'
    testImplementation 'junit:junit:4.12'
    implementation 'com.google.code.gson:gson:2.8.5'
    implementation 'com.squareup.retrofit2:adapter-rxjava2:2.5.0'
    implementation 'com.squareup.okhttp3:okhttp-urlconnection:3.13.1'
    implementation 'org.jetbrains:annotations:15.0'
    implementation 'com.squareup.retrofit2:converter-gson:2.3.0'
    implementation 'com.google.zxing:core:3.3.0'

    implementation 'io.reactivex.rxjava2:rxjava:2.2.6'
    implementation 'io.reactivex.rxjava2:rxandroid:2.0.1'
    implementation "com.facebook.react:react-native:+"

    implementation 'com.gyf.immersionbar:immersionbar:3.0.0-beta01'
    implementation project(path: ':comlib')
    implementation 'com.android.support:multidex:1.0.3'
    implementation 'am.widget:smoothinputlayout:1.1.2'
    implementation project(path: ':photoalbumlibrary')
    implementation 'com.github.bigmanLau:CardviewFix:1.0.3'

    //信鸽部分
    implementation 'com.tencent.xinge:xinge:4.3.2-release'
    implementation 'com.tencent.jg:jg:1.1'
    implementation 'com.tencent.wup:wup:1.0.0.E-Release'
    implementation 'com.tencent.mid:mid:4.0.7-Release'
    //umeng部分
    implementation files('libs/umeng-common-2.0.1.jar')
    implementation files('libs/umeng-analytics-8.0.0.jar')
    implementation files('libs/umeng-share-core-6.9.4.jar')
    implementation files('libs/umeng-share-QQ-simplify-6.9.4.jar')
    implementation files('libs/umeng-share-sina-simplify-6.9.4.jar')
    implementation files('libs/umeng-share-wechat-simplify-6.9.4.jar')
    implementation files('libs/umeng-sharetool-6.9.4.jar')

    implementation 'com.github.ittianyu:BottomNavigationViewEx:2.0.4'
    implementation 'pl.droidsonroids.gif:android-gif-drawable:1.2.17'

    implementation 'com.dou361.ijkplayer:jjdxm-ijkplayer:1.0.6'
    implementation('com.dou361.ijkplayer:jjdxm-ijkplayer:1.0.5') {
        exclude group: 'com.android.support', module: 'appcompat-v7'
    }


}
